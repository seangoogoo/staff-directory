'use strict';function updateDepartmentOptions(c,b,g,d=""){if(!c)return resetDepartmentOptions(b,g,d),Promise.resolve();const e=d||b.value;return new Promise((f,m)=>{fetch(`${window.APP_BASE_URI||""}/includes/ajax_handlers.php?action=get_departments_by_company&company=${encodeURIComponent(c)}`).then(a=>{if(!a.ok)throw Error(`HTTP error! Status: ${a.status}`);return a.json()}).then(a=>{if(!a.success)throw Error(a.error||"Unknown error");a=a.departments||[];b.innerHTML="";const k=document.createElement("option");
k.value="";k.text="All Departments";b.appendChild(k);a.forEach(l=>{const h=document.createElement("option");h.value=l;h.text=l;l===e&&(h.selected=!0);b.appendChild(h)});-1===a.indexOf(e)&&(b.value="");f(a)}).catch(a=>{console.error("Error fetching departments:",a);resetDepartmentOptions(b,g);m(a)})})}
function resetDepartmentOptions(c,b,g=""){const d=g||c.value;c.innerHTML="";b.forEach(e=>{const f=document.createElement("option");f.value=e.value;f.text=e.text;f.selected=d&&e.value===d?!0:e.selected;c.appendChild(f)});d&&(c.value=d)}
function updateCompanyOptions(c,b,g,d=""){if(!c)return resetCompanyOptions(b,g,d),Promise.resolve();const e=d||b.value;return new Promise((f,m)=>{fetch(`${window.APP_BASE_URI||""}/includes/ajax_handlers.php?action=get_companies_by_department&department=${encodeURIComponent(c)}`).then(a=>{if(!a.ok)throw Error(`HTTP error! Status: ${a.status}`);return a.json()}).then(a=>{if(!a.success)throw Error(a.error||"Unknown error");a=a.companies||[];b.innerHTML="";const k=document.createElement("option");k.value=
"";k.text="All Companies";b.appendChild(k);a.forEach(l=>{const h=document.createElement("option");h.value=l;h.text=l;l===e&&(h.selected=!0);b.appendChild(h)});-1===a.indexOf(e)&&(b.value="");f(a)}).catch(a=>{console.error("Error fetching companies:",a);resetCompanyOptions(b,g);m(a)})})}
function resetCompanyOptions(c,b,g=""){const d=g||c.value;c.innerHTML="";b.forEach(e=>{const f=document.createElement("option");f.value=e.value;f.text=e.text;f.selected=d&&e.value===d?!0:e.selected;c.appendChild(f)});d&&(c.value=d)}window.FilterCore={updateDepartmentOptions,resetDepartmentOptions,updateCompanyOptions,resetCompanyOptions};